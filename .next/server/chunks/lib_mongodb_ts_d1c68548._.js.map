{"version":3,"sources":["../../../lib/mongodb.ts"],"sourcesContent":["/**\n * MongoDB Client Setup\n * \n * Install: npm install mongodb (or pnpm add mongodb)\n * \n * This file provides MongoDB client for database operations\n * MongoDB is optional - only loads if MONGODB_URI is configured\n */\n\nlet client: any = null\nlet db: any = null\nlet MongoClient: any = null\nlet Db: any = null\n\nconst uri = process.env.MONGODB_URI\nconst dbName = process.env.MONGODB_DB_NAME || 'fitnex'\n\n/**\n * Dynamically import MongoDB client (only if needed)\n */\nasync function getMongoClient() {\n  if (!MongoClient) {\n    try {\n      const mongodb = await import('mongodb')\n      MongoClient = mongodb.MongoClient\n      Db = mongodb.Db\n    } catch (error) {\n      throw new Error('MongoDB package not installed. Run: pnpm add mongodb')\n    }\n  }\n  return { MongoClient, Db }\n}\n\n/**\n * Get MongoDB database connection\n */\nexport async function getDatabase() {\n  if (!uri) {\n    throw new Error('MONGODB_URI not configured')\n  }\n\n  const { MongoClient: MC } = await getMongoClient()\n\n  if (db) {\n    return db\n  }\n\n  if (!client) {\n    client = new MC(uri)\n    await client.connect()\n  }\n\n  db = client.db(dbName)\n  return db\n}\n\n/**\n * Save form submission to MongoDB\n */\nexport async function saveFormSubmission(data: any) {\n  const database = await getDatabase()\n  const collection = database.collection('form_submissions')\n\n  const result = await collection.insertOne({\n    plan_type: data.plan || 'Standard',\n    name: data.name || data.name1,\n    phone: data.phone || data.phone1,\n    email: data.email || data.email1,\n    age: data.age || data.age1,\n    gender: data.gender || data.gender1,\n    country: data.country,\n    city: data.city,\n    occupation: data.occupation || data.occupation1,\n    fitness_experience: data.fitnessExperience || data.fitnessExperience1,\n    fitness_goal: data.fitnessGoal || data.fitnessGoal1,\n    package_duration: data.packageDuration,\n    current_weight: data.currentWeight || data.currentWeight1,\n    target_weight: data.targetWeight || data.targetWeight2,\n    message: data.message,\n    submitted_at: new Date(),\n  })\n\n  return result\n}\n\n/**\n * Close MongoDB connection\n */\nexport async function closeConnection() {\n  if (client) {\n    await client.close()\n    client = null\n    db = null\n  }\n}\n\n\n"],"names":[],"mappings":"uCASA,IAAI,EAAc,KACd,EAAU,KACV,EAAmB,KACnB,EAAU,KAER,EAAM,QAAQ,GAAG,CAAC,WAAW,CAC7B,EAAS,QAAQ,GAAG,CAAC,eAAe,EAAI,SAK9C,eAAe,IACb,GAAI,CAAC,EACH,GAAI,CACF,IAAM,EAAU,CAFF,KAEE,CAAA,uFAChB,EAAc,EAAQ,WAAW,CACjC,EAAK,EAAQ,EAAE,AACjB,CAAE,MAAO,EAAO,CACd,MAAM,AAAI,MAAM,uDAClB,CAEF,MAAO,aAAE,KAAa,CAAG,CAC3B,CAKO,eAAe,IACpB,GAAI,CAAC,EACH,GADQ,GACE,AAAJ,MAAU,8BAGlB,GAAM,CAAE,YAAa,CAAE,CAAE,CAAG,MAAM,WAElC,AAAI,IAAI,AAIH,IACH,EAAS,EADE,EACE,EAAG,GAChB,MAAM,EAAO,OAAO,IAGtB,EAAK,EAAO,EAAE,CAAC,GAEjB,CAKO,eAAe,EAAmB,CAAS,EAEhD,IAAM,EAAa,CADF,MAAM,GAAA,EACK,UAAU,CAAC,oBAqBvC,OAnBe,AAmBR,MAnBc,EAAW,SAAS,CAAC,CACxC,UAAW,EAAK,IAAI,EAAI,WACxB,KAAM,EAAK,IAAI,EAAI,EAAK,KAAK,CAC7B,MAAO,EAAK,KAAK,EAAI,EAAK,MAAM,CAChC,MAAO,EAAK,KAAK,EAAI,EAAK,MAAM,CAChC,IAAK,EAAK,GAAG,EAAI,EAAK,IAAI,CAC1B,OAAQ,EAAK,MAAM,EAAI,EAAK,OAAO,CACnC,QAAS,EAAK,OAAO,CACrB,KAAM,EAAK,IAAI,CACf,WAAY,EAAK,UAAU,EAAI,EAAK,WAAW,CAC/C,mBAAoB,EAAK,iBAAiB,EAAI,EAAK,kBAAkB,CACrE,aAAc,EAAK,WAAW,EAAI,EAAK,YAAY,CACnD,iBAAkB,EAAK,eAAe,CACtC,eAAgB,EAAK,aAAa,EAAI,EAAK,cAAc,CACzD,cAAe,EAAK,YAAY,EAAI,EAAK,aAAa,CACtD,QAAS,EAAK,OAAO,CACrB,aAAc,IAAI,IACpB,EAGF,CAKO,eAAe,IAChB,IACF,IADU,EACJ,EAAO,KAAK,GAClB,EAAS,KACT,EAAK,KAET"}